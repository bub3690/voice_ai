import torch
import numpy as np
import torch.nn as nn # 인공 신경망 모델들 모아놓은 모듈
import torch.nn.functional as F #그중 자주 쓰이는것들을 F로
import pandas as pd
import torchvision.models as models
from tqdm import tqdm



#confusion matrix 계산
#test set 계산.
#valid,test 모두 이용
def test_evaluate(model,model_name,test_x,test_y,file_name,save_result=False):


    #현재 고민중인 것. feature와 모델 네임을 받고 어떻게 전달할지.
    #학습시 파라미터 튜닝은?
    test_score,test_y,y_pred,y_probs = model.model.inference(test_x,test_y)


    # if model_name == 'baseline':
        
    if save_result:
        print("save result")
        return y_pred,test_y ,y_probs,file_name

    return y_pred,test_y
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           


def train(model,model_name,train_x,train_y,valid_x,valid_y):
    """
    학습. 파라미터 튜닝을 위해 valid도 필요
    """

    train_score,val_score = model.model.train(train_x,train_y,valid_x,valid_y)
    


    return model,train_score,val_score





